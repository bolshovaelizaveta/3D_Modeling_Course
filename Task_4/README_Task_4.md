# Task_4 по курсу "Трехмерные модели"

**Выполнила:** Большова Елизавета Александровна

# Результаты работы
Датасет: SemanticPOSS 
Модель: RandLA-Net
Итоговая точность (Overall Testing Accuracy): 0.8026.

**Описание процесса и анализ результатов**

1. Стандартный Pipeline из Open3D-ML не поддерживает корректную работу с объектами конфигурации в среде macOS ARM64. Для решения проблемы реализован ручной цикл обучения.
2. Предобученная модель (SemanticKITTI) требовала строго 3 канала (XYZ), в то время как на POSS устанавливали 4 канала (XYZ+I). Поэтому пришлось разделить пайплайн на два этапа, получилось избежать ошибок RuntimeError: Wrong feature dimension.
3. Библиотека PyTorch требует принудительного приведения меток классов к типу int32 перед конвертацией из NumPy в Tensor.
4. Модель RandLA-Net успешно инициализирована и обучена. Использование случайной выборки кадров из различных последовательностей позволило 0.8026. Модель демонстрирует стабильную сегментацию крупных объектов инфраструктуры.

Целью данной работы является реализация пайплайна семантической сегментации 3D-данных. В работе используется архитектура RandLA-Net и датасет SemanticPOSS. Выполнены этапы инициализации пустой модели, инференса предобученных весов (SemanticKITTI) и дообучения на новых данных.

**Технические особенности реализации**
1. Стандартный класс ml3d.pipelines.SemanticSegmentation из библиотеки Open3D-ML нестабильный при работе с ARM64 (ошибки доступа к атрибутам optimizer и model). Для обхода был использован ручной цикл обучения и валидации на чистом PyTorch.
2. Управление размерностью признаков. Для этапа инференса предобученной модели использовалась конфигурация с 3 входными каналами (XYZ), так как веса SemanticKITTI были обучены без учета интенсивности. Поэтому для дообучения на SemanticPOSS, была модель с 4 входными каналами (XYZ + Intensity). Недостающий канал был дополнен фиктивными признаками для сохранения целостности тензоров.
3. Семантический маппинг. На данных POSS был внедрен переmapping меток классов. Чтобы сопоставить индексы объектов POSS (например, Ground, Car, Building) с индексами, заложенными в весах модели KITTI.
4. Типизация данных. Приведение меток классов из формата uint32 к int32, что необходимо для корректной работы функций потерь в PyTorch.
5. Визуализация. Из-за ограничений графического ядра в Jupyter Lab, визуализация результатов реализована через Matplotlib.
